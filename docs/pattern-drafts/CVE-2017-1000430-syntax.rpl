pattern CVE-2017-1000430-syntax

mvar {
    calculate:ident
    size:ident
    buf:ident
}

util {
    p_calculate = ```
        fn $calculate() {
            #without! {
                #or! {
                    check_add();
                    check_sub();
                    check_mul();
                    check_div();
                }
            }
        }
    ```

    p_with_capacity = ```
        fn $f() {
            let $size = $calculate();
            let $buf = String::with_capacity($size);
        }
    ```
}

patt {
    p = 
        & p_calculate 
        & p_with_capacity
}
