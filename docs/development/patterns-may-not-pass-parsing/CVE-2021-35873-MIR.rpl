pattern CVE-2021-35873

patt {
    use alloc::ffi::c_str::CString;
    use core::ffi::c_str::CStr;
    use core::ptr::non_null::NonNull;

    p = #[mir] pub fn _ (..) -> _ {
        let $cstring: CString = _;
        let $cstring_ref: &CString = &$cstring;
        let $non_null: NonNull<[u8]> = copy ((((*$cstring_ref).inner).0).pointer);
        let $uslice_ptr: *const [u8] = copy $non_null.pointer;
        let $cstr_ptr: *const CStr = copy $uslice_ptr as *const CStr (PtrToPtr);
        let $cstr: &CStr = &(*$cstr_ptr);
        let $islice: *const [i8] = &raw const ((*$cstr).inner);
        let $iptr: *const i8 = move $islice as *const i8 (PtrToPtr);
        let $iptr_arg: *const i8;
        let $s: i32;
        drop($cstring);

        $s = _;
        $iptr_arg = copy $iptr;
        _ = $crate::ffi::sqlite3session_attach(move $s, move $iptr_arg);
    }
}