pattern CVE-2020-35881

patt {
    p_wrong_assumption_of_fat_pointer_layout_const_const = #[mir] fn _ (..) -> _ {
        let $ptr: *const $T = _;
        let $ref_to_ptr: &*const $T = &$ptr;
        let $ptr_to_ptr_t: *const *const $T = &raw const (*$ref_to_ptr);
        let $ptr_to_ptr: *const *const () = move $ptr_to_ptr_t as *const *const () (
            #or!{
                PtrToPtr,
                Transmute
            }
        );
        let $data_ptr: *const () = _;
    }

    p_wrong_assumption_of_fat_pointer_layout_const_mut = #[mir] fn _ (..) -> _ {
        let $ptr: *const $T = _;
        let $ref_to_ptr: &mut *const $T = &mut $ptr;
        let $ptr_to_ptr_t: *mut *const $T = &raw mut (*$ref_to_ptr);
        let $ptr_to_ptr: *mut *mut () = move $ptr_to_ptr_t as *mut *mut () (
            #or!{
                PtrToPtr,
                Transmute
            }
        );
        let $data_ptr: *mut () = _;
    }
    
    p_wrong_assumption_of_fat_pointer_layout_mut_const = #[mir] fn _ (..) -> _ {
        let $ptr: *mut $T = _;
        let $ref_to_ptr: &*mut $T = &$ptr;
        let $ptr_to_ptr_t: *const *mut $T = &raw const (*$ref_to_ptr);
        let $ptr_to_ptr: *const *mut () = move $ptr_to_ptr_t as *const *mut () (
            #or!{
                PtrToPtr,
                Transmute
            }
        );
        let $data_ptr: *const () = _;
    }
    
    p_wrong_assumption_of_fat_pointer_layout_mut_mut = #[mir] fn _ (..) -> _ {
        let $ptr: *mut $T = _;
        let $ref_to_ptr: &mut *mut $T = &mut $ptr;
        let $ptr_to_ptr_t: *mut *mut $T = &raw mut (*$ref_to_ptr);
        let $ptr_to_ptr: *mut *mut () = move $ptr_to_ptr_t as *mut *mut () (
            #or!{
                PtrToPtr,
                Transmute
            }
        );
        let $data_ptr: *mut () = _;
    }
}Ã¥