pattern CVE-2018-20992-MIR

patt {
    use std::vec::Vec;

    p_vec_set_len_to_extend[
        $T: ty
    ] = #[mir] pub fn _ (..) -> _ {
        let $vec: Vec<$T> = _;
        let $new_len: usize = _;
        let $vec_ref: &Vec<$T> = &$vec;
        let $old_len: usize = copy ((*$vec_ref).len);
        // SwitchInt Here or If here?
        #without!(if $old_len >= $new_len) {
            let $vec_mut_ref: &mut Vec<$T> = &mut $vec;
            (*$vec_mut_ref).len = copy $new_len;
        }
    }
}