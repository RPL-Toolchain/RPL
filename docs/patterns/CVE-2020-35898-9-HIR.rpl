pattern CVE-2020-35898/9

patt {
    use std::cell::UnsafeCell;
    use std::rc::Rc;
    use std::clone::Clone;

    p_rc_unsafe_cell[
        $T: ty
    ] = {                       
        pub struct $Cell {
            $inner: Rc<UnsafeCell<$T>>,
        }

        impl Clone for $Cell {
            fn clone(&self) -> Self {
                $Cell::#new!{
                    $inner: self.$inner.clone(),
                }
            }
        }

        impl $Cell {
            fn $get_mut(&mut self) -> &mut $T {
                @let $res = *self.$inner;
                @let $res = $res.as_ref();
                @let $res = $res.get();
                unsafe { &mut *$res }
            }
        }
    }
}