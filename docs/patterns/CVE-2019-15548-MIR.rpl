pattern CVE-2019-15548-MIR

patt {
    use ncurses::instr;
    use libc::c_char;
    use std::string::String;

    // Only work for crate::ll::instr or ncures::instr
    p1[
        $T: ty,
    ] = #[mir] fn _ (..) -> _ {
        let $src: &String = _;
        let $bytes: &[u8] = String::as_bytes(move $src);
        let $ptr: *const u8 = slice::as_ptr(copy bytes);
        let $dst = *const c_char = copy $ptr as *const c_char (Transmute);
        let $ret: $T = $crate::ll::instr($dst);
    }

    // Pass a string ptr to $c_func
    p2 = #[mir] fn _ (..) -> _ {
        let $ptr = *const c_char = _;
        _ = $c_func(move $ptr);
    }
}